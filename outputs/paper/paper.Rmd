---
title: "COVID-19 Cases in Toronto"
subtitle: "Examine All cases from January 2020 to January 2021"
author: "Xinyi Xu"
thanks: "https://github.com/xuxinyi720/Assignment1.git"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "COVID-19 has been recognized as a global threat; thus, numerous studies have been conducted in order to control and prevent this pandemic. I am going to use the dataset from Toronto Public Health to summarize and analyze data to find how the pandemic is evolving, and assess severity and risk in Toronto. It is crucial for the Ministry of Health and our local public health institution to have an in-depth understanding of the disease and develop the necessary interventions to prevent further spread."
output:
  bookdown::pdf_document2:
toc: FALSE
bibliography: references.bib
---

```{r Workplace setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(opendatatoronto)
library(tidyverse)
library(ggplot2)
library(scales)
library(kableExtra)
library(dplyr)
library(gt)
```

# Introduction

COVID-19, a worldwide pandemic, has reached to more than 150 nations, and is still spreading nowadays. This report aims to summarize the data and explore the trends among all COVID-19 cases reported in Toronto. I found that number of cases has risen dramatically from August to December, and finally had approximately 19,000 new cases in December. Also, I recognized the three most risky neighborhood area in Toronto. 20-29 years-old is the most vulnerable age group among all nine age-groups. There are three possible outcomes, and the recovery rate is 86.32%.

This paper includes two main parts which is data section and analysis section. In data section, I am going to describe the dataset from multiple aspects including source of the data, methodology of collections, ethical bias, as well as the detail dataset description. In analysis section, I will use the tidyverse [@citeTidyverse], kableExtra[@citekable], and ggplot2 [@citeggplot] to generate several charts and tables in the Rstudio environment [@citeR].  The descriptive analysis enhances our understanding of how total number of cases has been fluctuated over one year, how COVID-19 impacts each neighborhood area, which age group is the most susceptible to infection.


# Data
## Source of the data
The dataset was published by Toronto Public Health. It was updated weekly, and it was last refreshed on January 20, 2021. Toronto Public Health takes responsibility of managing and tracking all confirmed and probable cases. The data are extracted from the provincial communicable disease reporting system (iPHIS) and Toronto's custom COVID-19 case management system (CORES) and combined for reporting. [@citeData]

## Methodology of data collection
Toronto Public Health collects data by receiving the reports of COVID-19 cases every day. To be specific, when a case that meets the provincial case definition[@citeDefinition], Toronto Public Health will immediately begin a detailed and careful investigation of each individual. In terms of how respondents are found, each individual will be directly collected from laboratory to local health department. All information will be summarized to show the trend of the pandemic. 

## Bias
One of the most significant ethical biases is that sex-disaggregated data on confirmed COVID-19 infections and deaths are incomplete. According to the review from Data2X and Open Data Watch, accurate gender data is considered necessary for a gender-sensitive response to COVID-19 [@citeBias]. The challenge is not only that people are not collecting gender data, but also that they are not uniformly collecting it. 


## Dataset Description
The dataset provides a list of all COVID-19 cases in Toronto from January 2020 to January 2021. There are 77,872 rows in total, as well as 18 variables describing each observation. Generally, the dataset contains demographic data, geographic data, and severity information for all confirmed and probable cases. To be specific, each case has its unique ID, episode date, reported date, and hospitalized record. Patients are coded into nine age groups and four gender categories. Also, according to the principles of epidemiology, each individual has been classified into either sporadic (occurring in the community) or outbreak-associated. For each sporadic case, it indicates the most likely way of infection, including travel, close contact with a case, institutional setting, healthcare setting, community, pending, and unknown. Also, there are three possible outcomes which is active, fatal, and resolved. In addition, Toronto is divided into 140 neighborhoods, and its corresponding FSA (first three characters of postal code) is recorded in the dataset for further local planning.

```{r Workplace set-up, message=FALSE, echo = FALSE}
### Workplace set-up ###
# install.packages("opendatatoronto")
#install.packages("ggplot2")
library(opendatatoronto)
library(tidyverse)
library(ggplot2)
library(scales)
library(kableExtra)
library(dplyr)
library(gt)
```


```{r Get data, message=FALSE, echo = FALSE}
### Get data ###
COVID_data<- 
  opendatatoronto::search_packages("COVID-19 Cases in Toronto")%>%
  opendatatoronto::list_package_resources()%>%
  filter(name=="COVID19 cases")%>%
  select(id)%>%
  opendatatoronto::get_resource()

### Split date ###
COVID_data<- 
  COVID_data %>%
  dplyr::mutate(year = lubridate::year(COVID_data$`Reported Date`), 
                month = lubridate::month(COVID_data$`Reported Date`), 
                day = lubridate::day(COVID_data$`Reported Date`))
```

# Descriptive analysis

First of all, we make a line chart to visualize the fluctuation in the total number of cases in 2020. We can see that the number of cases has hit the first peak to over 5000 cases in April, and has decreased from May to August. However, number of cases has increased significantly from August to December, and finally reached approximately 19,000 cases.(Figure \@ref(fig:line-1)). 


```{r line-1, fig.cap="line-1",warning=FALSE,message=FALSE, echo = FALSE, fig.width=8, fig.height=4}
data_2020<-
  COVID_data%>%
  filter(COVID_data$year == 2020)%>%
  group_by(month)%>%
  summarise(Total = n())

ggplot(data_2020, aes(x=month, y=Total))+
  geom_line( 
    color="red")+
  labs(x = "Months",
       y = "Number of Cases",
       title = "New Cases in Each Month in 2020")+
  scale_x_continuous(breaks= pretty_breaks())+
  theme(plot.title = element_text(hjust = 0.5))
```

In addition, by drawing the bar chart, we are able to gain insight into how this pandemic affect each age group. In other word, we can know 20 to 29 years-old group is the most susceptible to infection, so that we can carry out prevention planning for targeted age groups. (Figure \@ref(fig:bar-chart-1))


```{r bar-chart-1,fig.cap="bar-chart-1",warning=FALSE,message=FALSE,echo = FALSE, fig.width=10, fig.height=8}
COVID_data %>%
  ggplot(mapping = aes( x = `Age Group`, fill = `Client Gender`))+
  geom_bar()+
  theme_minimal()+
  labs(x = "Age Group",
       y = "Number of Cases",
       fill = "Patient Gender",
       title = "Number of Patient in Each Age Group")+
  theme(axis.text.x = element_text(angle = 90),
        title =element_text(size=20,hjust = 0.5)
        )
```

Finally, the finding of the study enhances our understanding of how COVID-19 impacts each neighborhood areas differently in Toronto. According to the second bar chart, we can summarize the three most vulnerable areas by its FSA, which is M9V, M1B, and M3N. This information could also help the public health system to inform planning and equitable prioritization of public health resources. 
(Figure \@ref(fig:bar-chart-2))


```{r bar-chart-2, fig.cap="bar-chart-2",warning=FALSE,message=FALSE,echo = FALSE, fig.width=20, fig.height=8}
COVID_data %>%
  ggplot(mapping = aes( x = FSA, fill = `Source of Infection`))+
  geom_bar()+
  theme_minimal()+
  labs(x = "Neighbourhood Name",
       y = "Number of cases",
       fill = "Source of infection",
       title = "Cases with different source of infection")+
  theme(axis.text.x=element_text(angle=90,margin = margin(1, unit = "cm"),siz=12,hjust = 0.5, vjust =1),
        title =element_text(size=40, face='bold'))

```

```{r Table-1, fig.cap="Table-1",warning=FALSE, message=FALSE,echo = FALSE, fig.width=10, fig.height=8}
COVID_sum_table <-
  COVID_data %>%
  group_by(Outcome)%>%
  summarize(
    Total= n()
  )

COVID_sum_table%>%
  knitr::kable(caption = "Total Number of Three Outcomes", 
               col.names = c("Month", "Total Cases"),
               align = c('l', 'l', 'l'))
```


```{r Table-2, fig.cap="Table-2",message=FALSE,warning=FALSE, echo = FALSE, fig.width=10, fig.height=8}
COVID_table <-
  COVID_data %>% count(Outcome,`Age Group`)

COVID_table%>%
  knitr::kable(caption = "Outcomes of All Age Group",col.names = c("Outcome", "Age Group", "Total"))
```


```{r Table-3, fig.cap="Table-3",message=FALSE,warning=FALSEï¼Œecho = FALSE, fig.width=10, fig.height=8}
data_2020<-
  COVID_data%>%
  filter(COVID_data$year == 2020)%>%
  group_by(month)%>%
  summarise(Total = n())

data_2020%>%
  knitr::kable(caption = "Number of Cases in Each Month in 2020", 
               col.names = c("Month", "Total"))
```





\newpage


# References


